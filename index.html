<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doomsday algorithm trainer</title>
    <link rel="stylesheet" type="text/css" href="index.css" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="ios/1024.png" type="image/png" />
  </head>
  <body>
    <div class="horizontalClamp">
      <div class="date">
        <h1 id="date_title"></h1>
        <h2 id="comment"></h2>
        <h2 id="time"></h2>
      </div>
      <div class="answerButtonsContainer">
        <button class="dowButton" id="monday">Monday</button>
        <button class="dowButton" id="tuesday">Tuesday</button>
        <button class="dowButton" id="wednesday">Wednesday</button>

        <button class="dowButton" id="thursday">Thursday</button>
        <button class="dowButton" id="friday">Friday</button>
        <button class="dowButton" id="saturday">Saturday</button>

        <button class="dowButton" id="sunday">Sunday</button>
      </div>

      <div class="giveFeedback" id="feedback_viewer">
        <hr />
        <h2>Algorithm steps</h2>
        <p>
          Click on all the steps you think you've gone off track (even if you've
          got the answer right).
        </p>
        <div class="algorithmSolved" id="alg_reconstruction"></div>
        <p class="watermark">
          View on
          <a href="https://github.com/George-Ober/doomsday-trainer">GitHub</a>.
        </p>
      </div>
      <div class="nextContainer" id="next_container">
        <button id="open_stats" class="nextButton">View Stats</button>
        <button id="next" class="nextButton">Next</button>
      </div>
      <div>
        <span>v15</span>
        <div id="update_menu" style="display: none">
          <span>An update is available, please restart the page :</span>
          <button class="nextButton" onclick="window.location.reload();">
            Update
          </button>
        </div>
      </div>
    </div>

    <div id="my_modal" class="modal">
      <!-- Modal Content -->
      <div class="modal-content">
        <h2>Statistics</h2>

        <div class="statsGrid">
          <div class="statsSquare" style="background-color: var(--red-bg)">
            <span class="statsTitleOne">You've played</span>
            <span class="statsValue" id="number_games"></span>
            <span class="statsTitleTwo" style="color: var(--red-text)"
              >games</span
            >
          </div>
          <div class="statsSquare" style="background-color: var(--blue-bg)">
            <span class="statsTitleOne">You've succeeded</span>
            <span class="statsValue" id="number_succeeded"></span>
            <span class="statsTitleTwo" style="color: var(--blue-text)"
              >guesses</span
            >
          </div>
          <div class="statsSquare" style="background: var(--sun-bg)">
            <span class="statsTitleOne">Your average time is</span>
            <span class="statsValue" id="avg10"></span>
            <span class="statsTitleTwo" style="color: var(--sun-text)"
              >over the last 10 games</span
            >
          </div>
          <div class="statsSquare" style="background: var(--lime-bg)">
            <span class="statsTitleOne">Your worst day is</span>
            <span
              class="statsValue"
              style="font-size: 1.2em"
              id="worstday"
            ></span>
            <span
              class="statsTitleTwo"
              style="color: var(--lime-text)"
              id="worstday_failures"
            ></span>
          </div>
          <div
            class="statsSquare"
            style="background: var(--pink-bg); width: 270px"
          >
            <span class="statsTitleOne">Your preferred century is</span>
            <span class="statsValue" id="preferred_century">1900s</span>
            <span
              class="statsTitleTwo"
              id="preferred_century_percentage"
              style="color: var(--pink-text)"
            ></span>
          </div>
        </div>
        <span style="color: var(--text-2)">More data will be coming soon</span>
        <div class="chartContainer">
          <canvas
            id="my_chart"
            style="width: 100%; max-width: 700px; margin: 0 auto"
          ></canvas>
        </div>
        <div class="nextContainer" style="display: flex">
          <button class="nextButton" id="download_btn">Download Data</button>
          <button class="nextButton" id="close_btn">Close Stats</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="index.js"></script>
    <script>
      if (typeof navigator.serviceWorker !== "undefined") {
        navigator.serviceWorker.register("sw.js").then((registration) => {
          registration.onupdatefound = () => {
            if (null != registration.active) {
              const t = registration.installing;
              t.onstatechange = () => {
                "installed" == t.state && showUpdate();
              };
            }
          };
        });
      }
      function showUpdate() {
        document.getElementById("update_menu").style.display = "block";
      }
    </script>
  </body>
</html>
